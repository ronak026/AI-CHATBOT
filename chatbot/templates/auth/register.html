{% extends "base.html" %}
{% load widget_tweaks %}
{% block title %}Register | AI Chatbot{% endblock %}

{% block content %}

<!-- Back Button -->
<div class="mb-6">
    <button onclick="history.back()"
            class="flex items-center gap-2 text-sm
                   hover:text-[#00ADB5] transition">
        <i data-lucide="arrow-left" class="w-4 h-4 icon-hover"></i>
        Back
    </button>
</div>

<section class="flex items-center justify-center py-16">

    <!-- Register Card -->
    <div class="w-full max-w-md
                bg-[#393E46]
                border border-[#00ADB5]/30
                rounded-3xl shadow-xl
                p-10">

        <!-- Header -->
        <div class="text-center mb-10">
            <i data-lucide="user-plus"
               class="w-12 h-12 mx-auto mb-3
                      text-[#00ADB5]"></i>

            <h2 class="text-3xl font-extrabold">
                Create Account
            </h2>

            <p class="text-gray-300 mt-2">
                Join and start chatting with AI
            </p>
        </div>

        <!-- Django Messages (Error/Success) -->
        {% if messages %}
            <div class="mb-6 space-y-3" id="messages-container">
                {% for message in messages %}
                    <div class="message-alert
                                text-sm
                                {% if message.tags == 'error' %}
                                    text-red-400
                                    bg-red-900/20
                                    border border-red-500/40
                                {% elif message.tags == 'success' %}
                                    text-green-400
                                    bg-green-900/20
                                    border border-green-500/40
                                {% else %}
                                    text-blue-400
                                    bg-blue-900/20
                                    border border-blue-500/40
                                {% endif %}
                                px-4 py-3 rounded-xl
                                flex items-center gap-2
                                animate-fade-in">
                        {% if message.tags == 'error' %}
                            <i data-lucide="alert-circle" class="w-5 h-5 flex-shrink-0"></i>
                        {% elif message.tags == 'success' %}
                            <i data-lucide="check-circle" class="w-5 h-5 flex-shrink-0"></i>
                        {% else %}
                            <i data-lucide="info" class="w-5 h-5 flex-shrink-0"></i>
                        {% endif %}
                        <span>{{ message }}</span>
                        <button type="button" 
                                class="ml-auto 
                                       {% if message.tags == 'error' %}text-red-400 hover:text-red-300{% elif message.tags == 'success' %}text-green-400 hover:text-green-300{% else %}text-blue-400 hover:text-blue-300{% endif %}"
                                onclick="this.closest('.message-alert').remove()">
                            <i data-lucide="x" class="w-4 h-4"></i>
                        </button>
                    </div>
                {% endfor %}
            </div>
        {% endif %}

        <!-- Register Form -->
        <form method="POST"
              enctype="multipart/form-data"
              class="space-y-6">

            {% csrf_token %}

            {% for field in form %}
                <div>
                    <label for="{{ field.id_for_label }}" class="block text-sm font-medium mb-2">
                        {{ field.label }}
                    </label>

                    {% if field.errors %}
                        {{ field|add_class:"w-full px-4 py-3 rounded-xl bg-[#222831] border border-red-500/50 text-[#EEEEEE] placeholder-gray-500 focus:outline-none focus:border-red-500 focus:ring-1 focus:ring-red-500 transition" }}
                        <p class="text-sm text-red-400 mt-2 flex items-center gap-1">
                            <i data-lucide="alert-circle" class="w-4 h-4"></i>
                            {{ field.errors|striptags }}
                        </p>
                    {% else %}
                        {{ field|add_class:"w-full px-4 py-3 rounded-xl bg-[#222831] border border-[#00ADB5]/30 text-[#EEEEEE] placeholder-gray-500 focus:outline-none focus:border-[#00ADB5] focus:ring-1 focus:ring-[#00ADB5] transition" }}
                    {% endif %}
                </div>
            {% endfor %}

            <!-- Submit Button -->
            <button type="submit"
                    class="w-full py-3 text-lg font-semibold
                           bg-[#00ADB5] text-black
                           rounded-xl
                           border border-[#00ADB5]
                           hover:bg-[#00c7d1]
                           active:scale-95
                           transition shadow-lg
                           flex items-center justify-center gap-2">
                <i data-lucide="user-check" class="w-5 h-5"></i>
                Create Account
            </button>
        </form>

        <!-- Footer -->
        <p class="text-center text-sm text-gray-400 mt-10">
            Already have an account?
            <a href="{% url 'login' %}"
               class="text-[#00ADB5] font-semibold hover:underline
                      transition">
                Login here
            </a>
        </p>

    </div>

</section>

<style>
    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(-10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .animate-fade-in {
        animation: fadeIn 0.3s ease-out;
    }
</style>

<script>
    // Auto-hide messages after 7 seconds
    document.addEventListener('DOMContentLoaded', function() {
        const messageAlerts = document.querySelectorAll('.message-alert');
        messageAlerts.forEach(alert => {
            setTimeout(() => {
                alert.style.transition = 'opacity 0.3s ease';
                alert.style.opacity = '0';
                setTimeout(() => alert.remove(), 300);
            }, 7000);
        });
    });
</script>

{% endblock %}